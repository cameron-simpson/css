#!/bin/sh
#
# Read a mail folder with mutt.
#	- Cameron Simpson <cs@zip.com.au>
#

cmd=$0
usage="Usage: $0 [some-mutt-options...] [mutt-folder]"

needhost "$HOMEHOST@$SYSTEMID" || exit 1

mfolder=+attn
muttopts=

badopts=
while :
do
  case $1 in
    +a)		termopts="$termopts $1" ;;
    -[nR])	muttopts="$muttopts $1" ;;
    -m)		muttopts="$muttopts $1 $2" ;;
    --)		shift; break ;;
    -?*)	echo "$cmd: unrecognised option: $1" >&2; badopts=1 ;;
    *)		break ;;
  esac
  shift
done

if [ $# -gt 0 ]
then
  case $1 in
    /*)		mfolder=$1 ;;
    +*)		mfolder=$1 ;;
    *.*)	mfolder=nntp://$NNTPSERVER/$1 ;;
    *)		mfolder=+$1 ;;
  esac
  shift
  [ $# = 0 ] || { echo "$cmd: extra arguments: $*" >&2; badopts=1; }
fi

[ $badopts ] && { echo "$usage" >&2; exit 2; }

cd || exit 1
exec term $termopts +ip -n "mutt $mfolder" scrif "mutt_$mfolder" mutt -f "$mfolder" $muttopts
