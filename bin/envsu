#!/bin/sh
#
# Wrapper for su to preserve environment.
#	- Cameron Simpson, January 1992
#
# Huge simplification. - cameron 20nov2011
#

[ $# -gt 0 ] || set -- "$SHELL"

# preserve environment, with small changes
set -- "USER=$su" "PS1=" "PS2=" "$@"
for envvar in `env | sed -n 's/^\([a-zA-Z_][a-zA-Z0-9_]*\)=.*/\1/p'| sort -r`
do
  eval "set -- \"$envvar=\$$envvar\" \"\$@\""
done
set -- env "$@"

##set -x
exec sux $suargs -u "$su" -- "$@"
