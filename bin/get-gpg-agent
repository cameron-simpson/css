#!/bin/sh
#
# Get the daemonised gpg-agent info, as for get-ssh-agent.
#	- Cameron Simpson <cs@zip.com.au> 30mar2005
#

cmd=$0
usage="Usage: $cmd [statefile]"

statefile=

badopts=

[ $# = 0 ] || { statefile=$1; shift; }

[ $# = 0 ] || { echo "$cmd: extra arguments: $*" >&2; badopts=1; }

[ $badopts ] && { echo "$usage" >&2; exit 2; }

# We 'ave already got one!
have-gpg-agent && exec stash-gpg-agent -

[ -n "$statefile" ] || statefile=`gpg-agent-statefile` || exit 1

[ -s "$statefile" ] \
&& . "$statefile" \
&& have-gpg-agent \
&& exec stash-gpg-agent -
