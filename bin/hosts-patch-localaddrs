#!/bin/sh
#
# Patch /etc/hosts (by default) with 127.0.0.n addresses with names from standard input.
# - Cameron Simpson <cs@cskk.id.au> 10apr2016
#

set -ue

n=1
while read -r name0 names
do
  case "$name0" in
    '' | \#* )  continue ;;
    PROXY)      namesfx=-proxy ;;
    *)          namesfx= names="$name0 $names" ;;
  esac
  n=$(( n + 1 ))
  printf "127.0.0.%d" "$n"
  for name in $names
  do  printf " $name$namesfx"
  done
  echo
done | hosts-patch-known -m 'LOCAL ADDRESSES' ${1+"$@"}
