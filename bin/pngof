#!/bin/sh -u
#
# Create a full colour PNG of the specified image file.
#	- Cameron Simpson <cs@zip.com.au> 19may2005
#

: ${TMPDIR:=/tmp}

# FC7 hack - GM use segfaulting for me just now
gm=     ##gm
[ -n "${PREFER_IMAGEMAGICK:-}" ] && gm=

cmd=$0
usage="Usage: $cmd imagefile"

[ $# = 1 ] || { echo "$usage" >&2; exit 2; }
imagefile=$1; shift

imtype=`file2mime "$imagefile"` || exit 1
[ "x$imtype" = 'ximage/png' ] && exec echo "$imagefile"

gm=
exec convof -C pngof -discard -x "$imagefile" $gm convert "$imagefile" "png:-"
