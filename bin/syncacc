#!/bin/sh
#
# Rsync my account from one place to another.
# Usually I use putacc to call this, but occasionally getacc.
#	- Cameron Simpson <cs@zip.com.au> 29jun2004
#

cmd=$0
usage="Usage: $cmd from to [rsync-options...]"

syncset=acc

[ $# -ge 2 ] || { echo "$usage" >&2; exit 2; }
from=$1 to=$2; shift; shift

case "$syncset" in
  /* | ./* | ../* ) ;;
  *)  syncset=$HOME/rc/sync/$syncset ;;
esac

cd || exit 1

stripslashes=`shqstr sed '/\/$/d; /^\.L\.\.[Tt]\.\.\.\.\.\. .* -> /d'`

filter_fd 1 "$stripslashes" \
  rsync -rlptHCi --delete --exclude=CVS/ --exclude=\*.swp --exclude=\*~ \
        "--include-from=$syncset" \
        ${1+"$@"} \
        "$from." "$to."
