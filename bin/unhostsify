#!/bin/sh
#
# Replace {hostname} with its IP address according to /etc/hosts.
# - Cameron Simpson <cs@cskk.id.au> 24dec2020
#

set -ue

cmd=$0
etc_hosts=/etc/hosts

badopts=

[ $# = 0 ] || { etc_hosts=$1; shift; }
[ $# = 0 ] || { echo "$cmd: extra arguments: $*" &2; badopts=1; }
[ -f "$etc_hosts" ] || { echo "$cmd: not a file: $etc_hsosts" >&2; badopts=1; }

[ $badopts ] && { echo "$usage" >&2; exit 2; }

exec re-subst -H "$etc_hosts" 's/{(?P<hostname>[^}]+)}/{{{hostname}}}/gf'
