#!/bin/sh -ue
#
# Try to set up the css env, then run a command.
#       - Cameron Simpson <cs@zip.com.au> 22may2009
#

set -ue

: ${OPTCSS:=''}

[ $# -gt 0 ] || set -- env

if [ -z "$OPTCSS" ]
then
  bindir=`dirname "$0"`
  bindir=`cd "$bindir"; pwd`
  OPTCSS=`dirname "$bindir"`
fi

# turn $OPTCSS into full path
case "$OPTCSS" in
  /*) ;; *) OPTCSS=`cd "$OPTCSS"; pwd` ;;
esac

if [ ! -s "$OPTCSS/env.sh" ]
then
  echo "$0: no $OPTCSS/env.sh, aborting" >&2
  exit 1
fi

export OPTCSS
. "$OPTCSS/env.sh"
exec "$@"
