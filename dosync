#!/bin/sh

[ "x$HOST@$SYSTEMID" = xamadeus@home ] \
|| { echo "$0: must be on amadeus@home" >&2
     exit 2
   }

ask "Is $HOST@$SYSTEMID up to date" || exit 1

rsync -avHP --rsync-path='rrsync zapff' /usr/local/opt/HOME/. work:/cameron/opt-HOME/redhat.x86.linux/. &

( # prepare the way
  snarfaddrs &
  for subdir in scripts public public/adzap public/moto im
  do ( cd "$HOME/$subdir" && myke _all ) &
  done
  wait
)

# push
syncwork &
synczip &
synctw &
syncjekyll &

wait
