#!/bin/sh

needhost amadeus@home || exit 1
ask "Is $HOST@$SYSTEMID up to date" || exit 1

pfx work:opt/redhat.x86.linux \
rsync -avHP --rsync-path='$HOME/scripts/rrsync kaper' /u/syncopt/redhat.x86.linux/HOME/. work:/cameron/opt-HOME/redhat.x86.linux/. &

( # prepare the way
  snarfaddrs &
  for subdir in scripts im \
		there/cs@zip.com.au/html \
		there/cskk.ezoshosting.com/html/cs \
		there/cskk.ezoshosting.com/html/cs/moto \
		there/adzapper.sourceforge.net/html
  do ( cd "$HOME/$subdir" || exit 1
       exec myke _all
     ) &
  done
  wait
  updsysscripts
)

# push real accounts
for w in @work @newt @jekyll @sf
do  pfx "$w" syncstuff "$w" &
done

# push stub accounts
for who in cameron2@alpha cameron2@janus
do  pfx "$who" syncsmall "$who" &
done

pfx sf syncsf &
pfx ezos syncezos &
pfx zip synczip &

wait
