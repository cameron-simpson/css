#!/bin/sh
#
# Operations to perform when entering a desktop.
#	- Cameron Simpson <cs@zip.com.au> 24mar2003
#

: ${LOGDIR:=$HOME/var/log}

exec </dev/null
exec >>$LOGDIR/console
exec 2>&1

thisdesk=$1
lastdesk=`currentdesk` || exit 1

if [ "x$thisdesk" != "x$lastdesk" ]
then
    currentdesk "$thisdesk"

    desktop "$thisdesk" shcmds | sh -x &
    desktop "$thisdesk" wmcmds | fvwmcmd &

    ( deskjob=`deskjob -d "$thisdesk"`
      case "$deskjob" in
	''|.|idle)	;;
	*)		job "$deskjob" ;;
      esac
    ) &
fi
