Return-Path: <python-dev-bounces+cs=zip.com.au@python.org>
Delivered-To: unknown
Received: from mail.zip.com.au (125.255.95.3) by janus.home with POP3-SSL; 07
  Oct 2011 10:43:02 -0000
Delivered-To: cs@zipworld.com.au
Received: from mailin3-syd3.pacific.net.au (mailin3-syd3.pacific.net.au [125.255.92.144])
	by mailstore2.syd.pacific.net.au (Postfix) with ESMTP id 301933C8D
	for <cs@zipworld.com.au>; Fri,  7 Oct 2011 21:42:00 +1100 (EST)
Received: from mail.python.org (unknown [82.94.164.166])
	by mailin3-syd3.pacific.net.au (Postfix) with ESMTP id A10FF4000A1
	for <cs@zip.com.au>; Fri,  7 Oct 2011 21:42:48 +1100 (EST)
Received: from albatross.python.org (localhost [127.0.0.1])
	by mail.python.org (Postfix) with ESMTP id 3SFS8N1xNqzPS6
	for <cs@zip.com.au>; Fri,  7 Oct 2011 12:41:56 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=python.org; s=200901;
	t=1317984116; bh=3oLu0LQiWHEuDjL+71qipaGneAalRhGsXI3eWOe6nEA=;
	h=Date:From:To:Message-ID:MIME-Version:In-Reply-To:References:Cc:
	 Subject:List-Id:List-Unsubscribe:List-Archive:List-Post:List-Help:
	 List-Subscribe:Content-Type:Content-Transfer-Encoding:Sender;
	b=oYJZgRY6v3gNV9FEaZGlnu3lAXGWp/+HkId2tJ1Bc31N8sdRiBylNlTKiJdHov9LW
	 6gJIVqVGALpOwSFniLCF6amWVEczJ6negYDBIjIaVdnBhfS5ZJe2PFswI0YCirLvTT
	 SLjQc59+T40RIJpAcSQh3p2F8NwJt8noB86YsIF0=
X-Original-To: python-dev@python.org
Delivered-To: python-dev@mail.python.org
Received: from albatross.python.org (localhost [127.0.0.1])
	by mail.python.org (Postfix) with ESMTP id 3SFS6Y5gzkzPLg
	for <python-dev@python.org>; Fri,  7 Oct 2011 12:40:21 +0200 (CEST)
X-Spam-Status: OK 0.002
X-Spam-Evidence: '*H*': 1.00; '*S*': 0.00; 'oct': 0.02; ':-)': 0.06;
	'received:edu.au': 0.07; 'run,': 0.07; 'subject:when': 0.07;
	'tests,': 0.07; 'python': 0.08; 'buildbot': 0.09; 'am,': 0.12;
	'subject:Issue': 0.15; 'arbitrarily': 0.16; 'differently,': 0.16;
	'explanation': 0.16; 'from:addr:cs': 0.16; 'from:addr:zip.com.au':
	0.16; 'from:name:cameron simpson': 0.16; 'message-
	id:@cskk.homeip.net': 0.16; 'out?': 0.16; 'passes.': 0.16;
	'places.': 0.16; 'received:202.125.174': 0.16;
	'received:202.125.174.133': 0.16;
	'received:boardofstudies.nsw.edu.au': 0.16;
	'received:cskk.homeip.net': 0.16;
	'received:harvey.boardofstudies.nsw.edu.au': 0.16;
	'received:homeip.net': 0.16; 'received:nsw.edu.au': 0.16;
	'subject:): ': 0.16; 'surprising': 0.16; 'wrote:': 0.16;
	'cheers,': 0.18; 'slightly': 0.19; 'cc:no real name:2**0': 0.20;
	'mechanism': 0.21; 'header:In-Reply-To:1': 0.22; 'runs': 0.23;
	'"not': 0.23; 'default,': 0.23; "shouldn't": 0.23; 'suite,': 0.23;
	'talked': 0.23; 'vs.': 0.23; 'code': 0.25; 'tests': 0.25;
	'suggestion': 0.26; 'host': 0.27; 'code,': 0.28; 'users.': 0.28;
	'discussed': 0.28; 'environment': 0.29; 'asking': 0.29;
	'cc:addr:python.org': 0.30; 'builder': 0.30; 'differently': 0.30;
	'invoke': 0.30; 'logic': 0.30; 'over.': 0.30; 'least': 0.31;
	'subject: \n\t': 0.32; 'actual': 0.32; 'generally': 0.32; 'does':
	0.32; 'anyone': 0.32; 'comment': 0.32; 'it.': 0.33; 'actually':
	0.33; "i've": 0.34; 'header:User-Agent:1': 0.34; 'setting': 0.34;
	'test': 0.34; 'things': 0.34; 'consensus': 0.34; 'root': 0.34;
	'solaris': 0.34; 'apply': 0.35; 'running': 0.35; 'speaking': 0.35;
	'unless': 0.36; 'anything': 0.36; 'charset:us-ascii': 0.36;
	'received:au': 0.36; 'another': 0.37; 'executing': 0.37; 'good.':
	0.37; 'thread': 0.37; 'machine': 0.37; 'put': 0.37; 'run': 0.37;
	'but': 0.37; 'especially': 0.37; 'think': 0.38; 'cc:2**2': 0.38;
	'some': 0.38; 'should': 0.38; 'subject:: ': 0.39; 'privileged':
	0.39; 'case': 0.39; 'subject: (': 0.39; "it's": 0.40; 'where':
	0.40; 'your': 0.61; 'address': 0.61; 'world': 0.62; 'life': 0.63;
	'full': 0.63; 'further': 0.64; 'believe': 0.65; 'here': 0.65;
	'valuable': 0.65; 'received:202': 0.66; 'here.': 0.66; 'cameron':
	0.67; 'resources,': 0.67; 'special': 0.67; 'care': 0.71;
	'anything.': 0.71; 'cutting': 0.73; '"all': 0.84; 'contributors':
	0.84; 'glyph': 0.84; 'isolated': 0.84; 'malicious': 0.84; 'sum':
	0.89
Received: from localhost (HELO mail.python.org) (127.0.0.1)
	by albatross.python.org with SMTP; 07 Oct 2011 12:40:21 +0200
Received: from harvey.boardofstudies.nsw.edu.au
	(mail2.rack1.boardofstudies.nsw.edu.au [202.125.174.133])
	by mail.python.org (Postfix) with ESMTP
	for <python-dev@python.org>; Fri,  7 Oct 2011 12:40:21 +0200 (CEST)
Received: from cskk.homeip.net (localhost.localdomain [127.0.0.1])
	by harvey.boardofstudies.nsw.edu.au (Postfix) with ESMTP id A40B24D3B5C;
	Fri,  7 Oct 2011 21:40:18 +1100 (EST)
Received: by janus.cskk.homeip.net (Postfix, from userid 1000)
	id 6F7DC100419B7; Fri,  7 Oct 2011 21:40:18 +1100 (EST)
Date: Fri, 7 Oct 2011 21:40:18 +1100
From: Cameron Simpson <cs@zip.com.au>
To: Glyph <glyph@twistedmatrix.com>
Message-ID: <20111007104018.GA18106@cskk.homeip.net>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <477C9A0C-5058-422D-A0D2-48060A7C947D@twistedmatrix.com>
User-Agent: Mutt/1.5.21 (2010-09-15)
References: <477C9A0C-5058-422D-A0D2-48060A7C947D@twistedmatrix.com>
Cc: "Stephen J. Turnbull" <stephen@xemacs.org>, python-dev@python.org,
	Andrew Bennetts <andrew@bemusement.org>, Terry Reedy <tjreedy@udel.edu>
Subject: Re: cpython (3.2): Issue #11956:
	Skip	test_import.test_unwritable_directory on FreeBSD when run as
X-BeenThere: python-dev@python.org
X-Mailman-Version: 2.1.12
Precedence: list
List-Id: Python core developers <python-dev.python.org>
List-Unsubscribe: <http://mail.python.org/mailman/options/python-dev>,
	<mailto:python-dev-request@python.org?subject=unsubscribe>
List-Archive: <http://mail.python.org/pipermail/python-dev>
List-Post: <mailto:python-dev@python.org>
List-Help: <mailto:python-dev-request@python.org?subject=help>
List-Subscribe: <http://mail.python.org/mailman/listinfo/python-dev>,
	<mailto:python-dev-request@python.org?subject=subscribe>
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: 7bit
Sender: python-dev-bounces+cs=zip.com.au@python.org
Errors-To: python-dev-bounces+cs=zip.com.au@python.org
X-Cats2Procmailrc-Rule: cats/home: python  python-dev      sender:python-dev-bounces+cs=zip.com.au@python.org
X-Label: python-dev
Content-Length: 3026

On 07Oct2011 06:18, Glyph <glyph@twistedmatrix.com> wrote:
| On Oct 7, 2011, at 5:10 AM, Stephen J. Turnbull wrote:
| 
| > The principle here is "ran as root" without further explanation is a
| > litmus test for "not bothering about security", even today.  It's
| > worth asking for explanation, or at least a comment that "all the
| > buildbot contributors I've talked to have put a lot of effort into
| > security configuration".
| 
| This is a valid point.  I think that Cameron and I may have
| had significantly different assumptions about the environment being
| discussed here.  I may have brought some assumptions about the build
| farm here that don't actually apply to the way Python does it.

Likewise. I state now that I have no actual knowledge of the practices
in the build farm(s).

| To sum up what I believe is now the consensus from this thread:
| 
| Anyone setting up a buildslave should take care to invoke the build in
| an environment where an out-of-control buildbot, potentially executing
| arbitrarily horrible and/or malicious code, should not damage anything.
| Builders should always be isolated from valuable resources, although
| the specific mechanism of isolation may differ.  A virtual machine is a
| good default, but may not be sufficient; other tools for cutting of the
| builder from the outside world would be chroot jails, solaris zones, etc.
|
| Code runs differently as privileged vs. unprivileged users.  Therefore
| builders should be set up in both configurations, running the full test
| suite, to ensure that all code runs as expected in both configurations.
| Some tests, as the start of this thread indicates, must have some
| special logic to make sure they do or do not run, or run differently,
| in privileged vs. unprivileged configurations, but generally speaking
| most things should work in both places.
|
| Access to root my provide access to slightly surprising resources,
| even within a VM (such as the ability to send spoofed IP packets,
| change the MAC address of even virtual ethernet cards, etc), and
| administrators should be aware that this is the case when configuring
| the host environment for a run-as-root builder.  You don't want to end
| up with a compromised test VM that can snoop on your network.
| 
| Have I left anything out? :-)

I think that the build and the tests should be different security
scopes/zones/levels: different users or different VMs. Andrew's
suggestion of a VM-for-tests sounds especially good.

And that I think the as-root tests suite shouldn't run unless the
not-root test suite passes.

Cheers,
-- 
Cameron Simpson <cs@zip.com.au> DoD#743
http://www.cskk.ezoshosting.com/cs/

It is not true that life is one damn thing after another -- it's one damn
thing over and over.    - Edna St. Vincent Millay
_______________________________________________
Python-Dev mailing list
Python-Dev@python.org
http://mail.python.org/mailman/listinfo/python-dev
Unsubscribe: http://mail.python.org/mailman/options/python-dev/cs%40zip.com.au
