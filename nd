#!/bin/sh
#
# Manipulate FVWM named desktops from command line.
#	- Cameron Simpson <cs@zip.com.au> 18jul2002
#

cmd=$0
usage="Usage: $cmd [-r] [desktop]"

rmdesk=
[ "x$1" = x-r ] && { rmdesk=1; shift; }

if [ $# = 0 ]
then
    if [ $rmdesk ]
    then echo "$cmd: must supply desktop with -r" >&2
	 echo "$usage" >&2
	 exit 2
    else deskname=`lastvalue desktop-$HOST-previous`
    fi
else deskname=$1; shift
fi

[ $# = 0 ] || { echo "$cmd: extra arguments: $*" >&2
		echo "$usage" >&2
		exit 2
	      }

[ $rmdesk ] && exec desktop -r "$deskname"

desknum=`desktop "$deskname"`	|| exit 1
set -x
fvwmcmd "Desk 0 $desknum" &
( lastdesk=`lastvalue "desktop-$HOST"`
  if [ "x$lastdesk" != "x$desknum" ]
  then
      lastvalue "desktop-$HOST-previous" "$lastdesk"
      lastvalue "desktop-$HOST" "$desknum"
  fi
) &
