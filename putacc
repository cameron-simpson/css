#!/bin/sh

needhost $HOMEHOST@home || exit 1

hARCH=$ARCH

[ $# = 1 ] || { echo "Usage: $0 [login@]hostname" >&2; exit 2; }
host=$1; shift

cd || exit 1
set -x
exec rsync -avHP --delete --exclude=CVS/ \
	'--include=/.bash_logout' \
	'--include=/.bash_profile' \
	'--include=/.bashrc' \
	'--include=/.less' \
	'--include=/.lesskey' \
	'--include=/.mailcap' \
	'--include=/.muttrc' \
	'--include=/.profile' \
	'--include=/.secret' \
	'--include=/.setvar' \
	'--include=/.ssh' \
	'--include=/.ssh/config' \
	'--exclude=/.ssh/*' \
	'--include=/.xinitrc' \
	'--include=/.xsession' \
	'--include=/.zshenv' \
	'--include=/.zprofile' \
	'--include=/bin' \
	"--include=/bin/$hARCH" \
	'--exclude=/bin/*' \
	'--include=/rc' \
	'--include=/rc/env' \
	'--include=/rc/mail' \
	'--include=/rc/mail/mailcap' \
	'--include=/rc/mail/mutt*' \
	'--include=/rc/mail/signature' \
	'--exclude=/rc/mail/*' \
	'--include=/rc/myke' \
	'--include=/rc/nvi' \
	'--include=/rc/perl' \
	'--include=/rc/shell' \
	'--include=/rc/ssh' \
	'--include=/rc/vi' \
	'--include=/rc/x11' \
	'--exclude=/rc/*' \
	'--include=/scripts' \
	'--include=/scripts/cs/' \
	'--include=/scripts/stubs/' \
	'--include=/scripts/synonyms/' \
	'--exclude=/scripts/*/' \
	'--include=/var' \
	'--include=/var/*/' \
	'--exclude=/var/*/*' \
	'--exclude=/var/*' \
	'--exclude=/*' \
	. "$host:."
