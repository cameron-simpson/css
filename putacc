#!/bin/sh

cmd=$0

needhost $HOMEHOST@home || exit 1

hARCH=$ARCH

[ $# = 0 ] && { echo "$cmd: missing login@hostname" >&2
		echo "Usage: $cmd [login@]hostname" >&2
		exit 2
	      }

cd || exit 1
set -x
for h
do
  pfx "$h" \
  rsync -avHP --delete --exclude=CVS/ \
	'--include=/.bash_logout' \
	'--include=/.bash_profile' \
	'--include=/.bashrc' \
	'--include=/.gtkrc' \
	'--include=/.less' \
	'--include=/.lesskey' \
	'--include=/.mailcap' \
	'--include=/.muttrc' \
	'--include=/.profile' \
	'--include=/.screenrc' \
	'--include=/.secret' \
	'--include=/.setvar' \
	'--include=/.ssh' \
	'--include=/.ssh/config' \
	'--exclude=/.ssh/*' \
	'--include=/.xinitrc' \
	'--include=/.xsession' \
	'--include=/.zprofile' \
	'--include=/.zshenv' \
	'--include=/.zshrc' \
	'--include=/rc' \
	'--include=/rc/env' \
	'--include=/rc/mail' \
	'--include=/rc/mail/mailcap' \
	'--include=/rc/mail/mutt*' \
	'--include=/rc/mail/signature' \
	'--exclude=/rc/mail/*' \
	'--include=/rc/myke' \
	'--include=/rc/nvi' \
	'--include=/rc/perl' \
	'--include=/rc/screen' \
	'--include=/rc/shell' \
	'--include=/rc/ssh' \
	'--include=/rc/vi' \
	'--include=/rc/x11' \
	'--exclude=/rc/*' \
	'--include=/scripts' \
	'--include=/scripts/cs/' \
	'--include=/scripts/stubs/' \
	'--include=/scripts/synonyms/' \
	'--exclude=/scripts/*/' \
	'--include=/var' \
	'--include=/var/*/' \
	'--exclude=/var/*/*' \
	'--exclude=/var/*' \
	'--exclude=/*' \
	. "$h:." \
	&
done
wait
