#!/bin/sh

cmd=$0

hARCH=$ARCH

force=

[ "x$1" = x-f ] && { force=1; shift; }
[ $# = 0 ] && { echo "$cmd: missing login@hostname" >&2
		echo "Usage: $cmd [-f] [login@]hostname..." >&2
		exit 2
	      }

[ $force ] || needhost $HOMEHOST@home || exit 1

cd || exit 1
set -x
for host
do
  pfx "$host" \
  rsync -rlptHvP --delete --exclude=CVS/ \
	'--include=/.bash_logout' \
	'--include=/.bash_profile' \
	'--include=/.bashrc' \
	'--include=/.getnews-state' \
	'--include=/.gtkrc' \
	'--include=/.less' \
	'--include=/.lesskey' \
	'--include=/.mailcap' \
	'--include=/.mh_profile' \
	'--include=/.muttrc' \
	'--include=/.profile' \
	'--include=/.screenrc' \
	'--include=/.secret' \
	'--include=/.setvar' \
	'--include=/.ssh' \
	'--include=/.ssh/config' \
	'--exclude=/.ssh/*' \
	'--include=/.xinitrc' \
	'--include=/.xsession' \
	'--include=/.zprofile' \
	'--include=/.zshenv' \
	'--include=/.zshrc' \
	'--include=/rc' \
	'--include=/rc/env' \
	'--include=/rc/getnews' \
	'--include=/rc/less' \
	'--include=/rc/lesskey' \
	'--include=/rc/mail' \
	'--include=/rc/mail/mailcap' \
	'--include=/rc/mail/mutt*' \
	'--include=/rc/mail/signature' \
	'--exclude=/rc/mail/*' \
	'--include=/rc/mh' \
	'--include=/rc/myke' \
	'--include=/rc/nvi' \
	'--include=/rc/perl' \
	'--include=/rc/screen' \
	'--include=/rc/shell' \
	'--include=/rc/ssh' \
	'--include=/rc/vi' \
	'--include=/rc/x11' \
	'--exclude=/rc/*' \
	'--include=/scripts' \
	'--include=/scripts/cs/' \
	'--include=/scripts/stubs/' \
	'--include=/scripts/synonyms/' \
	'--exclude=/scripts/*/' \
	'--include=/var' \
	'--include=/var/*/' \
	'--exclude=/var/*/*' \
	'--exclude=/var/*' \
	'--exclude=/*' \
	. "$host:." \
	&
done
wait
