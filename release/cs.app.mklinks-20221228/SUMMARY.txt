Modernise command, pass a RunState to the merge methods.
merge: check runstate more frequently, tweak progress bar.
assimilate: plumb runstate.
