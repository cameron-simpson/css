Many updates and small fixes.
