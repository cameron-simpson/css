#!/bin/sh
#
# Update my sourceforge projects.
#	- Cameron Simpson <cs@zip.com.au> 23oct2002
#

zapdir=$HOME/there/adzapper.sourceforge.net

dotag=
[ $# = 0 ] && { set adzapper-everyupdate@lists.sourceforge.net
		ask "Sure you want to post to everyupdate" || exit 1
		dotag=1
	      }
[ $# = 1 ] || { echo "Usage: $0 [address]" >&2; exit 2; }
addr=$1; shift

set -x
cd $zapdir/html || exit 1
myke || exit 1

rsync -avHPW --delete $HOME/there/adzapper.sourceforge.net/html/. sf:adzapper/htdocs/.

cd $zapdir/html/scripts || exit 1
( cd .. || exit 1
  echo Diff since last sync:
  cvs diff -r SYNCSF scripts/squid_redirect
  [ $dotag ] && cvs tag -F SYNCSF
) | mfiles "$addr" squid_redirect
